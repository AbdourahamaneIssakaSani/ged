{% extends 'layout.html' %}
{% block styles %}
    {{ super() }}
    {{ dropzone.load_css() }}
{% endblock %}
{% block content %}
    {{ super() }}
    <style>
      .dropzone{

      }
    </style>

    <!--<div class="container p-y-1">
        <div class="row m-b-1">
            <div class="col-sm-6 offset-sm-3">
                <form>
                    <div class="form-group inputDnD">
                    <label class="sr-only" for="inputFile">File Upload</label>
                    <input type="file" class="form-control-file font-weight-bold" id="inputFile" accept="image/*"
                           onchange="readUrl(this)" data-title="Drag and drop a file">
                </div>
                <div class="form-group inputDnD">
                    <label class="sr-only" for="inputFile">Description</label>
                    <textarea class="form-control font-weight-bold" placeholder="Description"></textarea>
                </div>
                <button type="reset" class="">
                    Supprimer
                </button>
                <button type="button" class="btn btn-dark" onclick="document.getElementById('inputFile').click()">
                    Charger
                </button>
                <button type="submit" class="btn btn-dark">
                    Soummette
                </button>
                </form>
            </div>

        </div>
    </div>

    <div>
        <span class="fas fa-folder" size="100" style="cursor: pointer"></span>
        <span>Dossier</span>
    </div>-->
    <form action="{{ url_for('user_bp.new_file') }}" enctype="multipart/form-data" method="post">
        <div class="form-group">
            <label for="exampleFormControlTextarea1">{{ file_form.description.label }}</label>
            {{ file_form.description(class="form-control") }}
        </div>
        <div class="form-group">
            <label for="exampleFormControlTextarea1">{{ file_form.file.label }}</label>
            {{ file_form.file(class="form-control") }}
        </div>
        <div class="form-control">
            {{ file_form.submit(class="btn btn-dark") }}
        </div>

    </form>
    {{ dropzone.create(action=url_for('user_bp.new_file')) }}
    <script>
function readUrl(input) {

if (input.files && input.files[0]) {
let reader = new FileReader();
reader.onload = (e) => {
let imgData = e.target.result;
let imgName = input.files[0].name;
input.setAttribute("data-title", imgName);
console.log(e.target.result);
}
reader.readAsDataURL(input.files[0]);
}

}
        /*function readUrl(input) {
            if (input.files && input.files[0]) {
                let reader = new FileReader();
                reader.onload = (e) => {
                    let imgData = e.target.result;
                    let imgName = input.files[0].name;
                    input.setAttribute("data-title", imgName);
                    console.log(e.target.result);
                }
                reader.readAsDataURL(input.files[0]);
            }
        }

        const dragEvents = ['dragenter', 'dragover', 'dragleave', 'drop'];
        const dragHighlight = ['dragenter', 'dragover'];
        const dragUnighlight = ['dragleave', 'drop'];
        const inputRange = document.querySelectorAll('.editor input');

        const dropArea = document.getElementById('drop-area');
        const iconElement = document.querySelector('.circle');
        const editorElement = document.querySelector('.editor');

        const preventDefaults = (e) => {
            e.preventDefault();
            e.stopPropagation();
        };

        const highlight = () => {
            iconElement.classList.add('highlight');
        };

        const unhighlight = () => {
            iconElement.classList.remove('highlight');
        };

        const previewFile = (file) => {
            let reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onloadend = function () {
                //let img = document.createElement('img');
                //img.src = reader.result;
                //img.classList.add('img-thumbnail')
                let fileName = document.createElement('span');
                fileName.innerText = file.files[0].name;
                //document.getElementById('gallery').appendChild(img);
                //editorElement.classList.add('is-visible');
            }
        };

        const handleFiles = (files) => {
            files = [...files];
            files.forEach(previewFile);
        };

        const handleDrop = (e) => {
            let dt = e.dataTransfer;
            let files = dt.files;

            console.log('files', files);

            handleFiles(files);
        };

        function handleUpdate() {
            console.log(this.value);
            const suffix = this.dataset.unit;
            document.documentElement.style.setProperty(`--${this.name}`, this.value + suffix);
        }

        inputRange.forEach(input => input.addEventListener('change', handleUpdate));
        inputRange.forEach(input => input.addEventListener('mousemove', handleUpdate));

        dragEvents.forEach(eventName => {
            dropArea.addEventListener(eventName, preventDefaults, false)
        });

        dragHighlight.forEach(eventName => {
            dropArea.addEventListener(eventName, highlight, false)
        });

        dragUnighlight.forEach(eventName => {
            dropArea.addEventListener(eventName, unhighlight, false)
        });


        dropArea.addEventListener('drop', handleDrop, false);*/
    </script>
{% endblock %}
{% block scripts %}
    {{ super() }}
    {{ dropzone.load_js() }}
    {{ dropzone.config() }}
{% endblock %}